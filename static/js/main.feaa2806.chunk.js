(this["webpackJsonpchatui-demo"]=this["webpackJsonpchatui-demo"]||[]).push([[0],{176:function(e,t,n){},177:function(e,t,n){},183:function(e,t,n){},197:function(e,t){},199:function(e,t){},209:function(e,t,n){},210:function(e,t,n){},212:function(e,t,n){},213:function(e,t,n){},214:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),r=n(34),s=n.n(r),i=n(2),o=(n(175),n(30)),l=n(9),u=n(42),j=n(13),d=n(222),b=n(224),m=n(103),f=(n(176),n(177),n(4));function h(e){return Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)("div",{className:"userItem-Bar",onClick:function(){e.onClick()},children:[Object(f.jsx)("div",{className:"userItem-Avatar-div",children:Object(f.jsx)(j.Avatar,{className:"userItem-Avatar",src:e.Avatar,size:"lg",alt:"\u65e0\u6cd5\u52a0\u8f7d\u5934\u50cf"})}),Object(f.jsxs)("div",{className:"userItem-content",children:[Object(f.jsx)(j.Text,{className:"userItem-name",truncate:1,children:e.name}),Object(f.jsx)(j.Text,{className:"userItem-text",truncate:1,children:e.text})]}),Object(f.jsx)(j.Text,{className:"userItem-date",children:e.date})]})})}var g=function(e){var t=Object(c.useState)(""),n=Object(i.a)(t,2),a=n[0],r=n[1],s=Object(c.useState)([]),g=Object(i.a)(s,2),O=g[0],x=g[1],v=Object(c.useState)(!0),p=Object(i.a)(v,2),k=p[0],I=p[1],B=Object(c.useState)(1),y=Object(i.a)(B,2),C=y[0],M=y[1],N=Object(c.useState)(!0),S=Object(i.a)(N,2),T=S[0],w=S[1];Object(c.useEffect)((function(){var e=function(){var e=Object(u.a)(Object(o.a)().mark((function e(){var t;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,I(!0),e.next=4,d.a.get("/api/chat/list?all=false&pageIndex=".concat(C,"&pageSize=20&name="));case 4:(t=e.sent).data.rows.length>0?(x((function(e){return[].concat(Object(l.a)(e),Object(l.a)(t.data.rows))})),M((function(e){return e+1}))):w(!1),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Error fetching data:",e.t0);case 11:return e.prev=11,I(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})));return function(){return e.apply(this,arguments)}}();T&&e()}),[C,T]);var A=O.filter((function(e,t,n){return e.nickname.includes(a)})).map((function(t){var n={name:t.nickname,img:t.localAvatar,talker:t.talker};return Object(f.jsx)(h,{Avatar:n.img,name:n.name,onClick:function(){return e.onClickMe(n)}},Object(m.a)())}));return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(j.Input,{className:"search-input",type:"text",placeholder:"\u641c\u7d22\u7528\u6237...",onChange:function(e){return r(e)}}),Object(f.jsxs)("div",{style:{height:"770px",overflow:"auto"},children:[A,k&&Object(f.jsx)(b.a,{className:"Divider-end",plainp:!0,children:"Loading..."}),!k&&!T&&""===a&&Object(f.jsx)(b.a,{className:"Divider-end",plain:!0,children:"\u5df2\u7ecf\u5230\u5e95\u5566 \ud83e\udd10"})]})]})},O=n(72),x=n(26),v=n.n(x);n(183);function p(e){return Object(f.jsxs)("div",{className:"ChatUiBar",children:[Object(f.jsx)(j.IconButton,{className:"ChatUiBar--Btn",icon:"chevron-left",onClick:e.onClickBack}),Object(f.jsx)(j.Text,{className:"ChatUiBar--Text",truncate:1,children:e.title}),Object(f.jsx)(j.IconButton,{className:"ChatUiBar--Btn",icon:"ellipsis-h",onClick:e.onClickMore,style:{visibility:e.visibility?"hidden":"visible"}})]})}function k(e){var t="right"!==e.message.position,n=Object(c.useMemo)((function(){return e.renderMessageContent(e.message)}),[e.message]);return Object(f.jsxs)("div",{className:"MessageBubble",children:[Object(f.jsx)("time",{className:"Time",dateTime:v()(e.message.createdAt).format(),children:v()(e.message.createdAt).format("YYYY\u5e74M\u6708D\u65e5 HH:mm")}),n.type===j.Bubble?Object(f.jsxs)("div",{className:"MessageBubble-content"+(t?"-left":"-right"),children:[Object(f.jsx)("div",{className:"MessageBubble-content-Avatar",children:t&&Object(f.jsx)(j.Avatar,{className:"MessageBubble-Avatar-left",src:e.message.user.avatar,size:"md",alt:"\u65e0\u6cd5\u52a0\u8f7d\u5934\u50cf"})}),Object(f.jsxs)("div",{className:"Bubble"+(t?"-left":"-right"),children:[Object(f.jsx)(j.Text,{className:"MessageBubble-Name"+(t?"-left":"-right"),truncate:1,children:e.message.user.name}),n]}),Object(f.jsx)("div",{className:"MessageBubble-content-Avatar",children:!t&&Object(f.jsx)(j.Avatar,{className:"MessageBubble-Avatar-right",src:e.message.user.avatar,size:"md",alt:"\u65e0\u6cd5\u52a0\u8f7d\u5934\u50cf"})})]}):n]})}function I(e){var t=Object(c.useRef)(0),n=Object(c.useRef)(null);return Object(c.useEffect)((function(){0!==t.current&&n.current&&(n.current.scrollTop=-(n.current.scrollHeight-t.current),t.current=0,n.current=null)}),[e.messages]),Object(f.jsx)("div",{id:"scrollableDiv",children:Object(f.jsx)(O.a,{scrollableTarget:"scrollableDiv",dataLength:e.messages.length,next:function(){e.next()},hasMore:e.hasMore,inverse:!0,scrollThreshold:1,onScroll:function(c){0===c.srcElement.scrollTop?(t.current=c.srcElement.scrollHeight,n.current=c.srcElement,e.atBottom&&e.atBottom()):(t.current=0,n.current=null)},children:e.messages.map((function(t){return Object(f.jsx)(k,{message:t,renderMessageContent:e.renderMessageContent},t.createdAt)}))})})}function B(e){return Object(f.jsxs)("div",{className:"ChatUi",children:[Object(f.jsx)(p,{title:e.name,onClickMore:e.onClickMore,onClickBack:e.onClickBack,visibility:e.moreVisibility}),Object(f.jsx)(I,{messages:e.messages,next:e.fetchMoreData,hasMore:e.hasMore,renderMessageContent:e.renderMessageContent,atBottom:e.atBottom})]})}function y(e){var t=Object(c.useState)(e),n=Object(i.a)(t,2),a=n[0],r=n[1];return{messages:a,prependMsgs:function(e){r(e.concat(a))},appendMsgs:function(e){r(a.concat(e))}}}var C=n(105),M=n.n(C),N=(n(209),n(210),n(225)),S=n(220),T=n(167),w=(n(211),n(151)),A=n.n(w),E=n(152),R=n.n(E),D=n(221);function _(e){switch(e.type){case"1":return Object(f.jsx)(j.Bubble,{content:e.content.content,id:e._id});case"3":return Object(f.jsx)(j.Bubble,{type:"image",id:e._id,children:Object(f.jsx)(D.a,{src:e.content.mediaSourcePath||e.content.mediaBCKPath||e.content.mediaPath,alt:"\u56fe\u7247"})});case"34":return Object(f.jsx)(j.Bubble,{id:e._id,children:Object(f.jsx)("audio",{controls:!0,src:e.content.mediaPath})});case"43":return Object(f.jsx)(j.Bubble,{type:"video",id:e._id,children:Object(f.jsx)(j.Video,{src:e.content.mediaPath})});case"47":return Object(f.jsx)(j.Bubble,{type:"image",id:e._id,children:Object(f.jsx)("img",{src:e.content.emojiInfo.cdnUrl,alt:"\u8868\u60c5\u65e0\u6cd5\u52a0\u8f7d"})});case"48":return Object(f.jsx)(j.Bubble,{content:"[\u4f4d\u7f6e\u6d88\u606f\ud83d\ude02]",id:e._id});case"49":return Object(f.jsx)(j.Bubble,{content:"[\u5361\u7247\u4fe1\u606f]",id:e._id});case"10000":case"268445456":return Object(f.jsx)("div",{style:{margin:"0 auto"},id:e._id,children:Object(f.jsx)(j.SystemMessage,{content:e.content.content})});case"436207665":case"419430449":case"318767153":return"text";case"1090519089":return"";case"822083633":var t=void 0;return M.a.parseString(e.content.content,(function(n,c){if(n)console.error("XML parsing error: ",n),t=Object(f.jsx)(j.Bubble,{type:"text",content:"XML parsing error: {error}"});else{var a=c.msg.appmsg[0].refermsg[0].displayname[0]+": ";if("1"===c.msg.appmsg[0].refermsg[0].type[0])a+=c.msg.appmsg[0].refermsg[0].content[0];else if("43"===c.msg.appmsg[0].refermsg[0].type[0])a+="[\u89c6\u9891]";else if("3"===c.msg.appmsg[0].refermsg[0].type[0])a+="[\u56fe\u7247]";else if("34"===c.msg.appmsg[0].refermsg[0].type[0])a+="[\u8bed\u97f3]";else if("49"===c.msg.appmsg[0].refermsg[0].type[0]){var r=void 0;M.a.parseString(c.msg.appmsg[0].refermsg[0].content[0],(function(e,t){r=e?"\u5f15\u7528\u7684\u5f15\u7528xml\u89e3\u6790\u5931\u8d25":t.msg.appmsg[0].title?t.msg.appmsg[0].title[0]:"\u672a\u77e5\u5f15\u7528\u7684\u5f15\u7528"})),a="[\u5f15\u7528]\n"+a,a+=r}else a+="\u9700\u8981\u5904\u7406\u7684\u5f15\u7528\u7c7b\u578b"+c.msg.appmsg[0].refermsg[0].type[0];var s=c.msg.appmsg[0].title[0];t=Object(f.jsxs)(j.Bubble,{id:e._id,children:[Object(f.jsx)(j.Text,{breakWord:!0,children:a}),Object(f.jsx)(j.Text,{children:"----"}),Object(f.jsx)(j.Text,{children:s})]})}})),t;default:return console.log(e),Object(f.jsx)(j.Bubble,{content:"\u672a\u77e5\u7c7b\u578b: ".concat(e.type),id:e._id})}}function z(e){var t=e.info,n=e.createTime,a=e.onClickBack,r=y([]),s=r.messages,l=r.prependMsgs,j=r.appendMsgs,b=Object(c.useState)(1),m=Object(i.a)(b,2),h=m[0],g=m[1],O=Object(c.useState)(!1),x=Object(i.a)(O,2),v=x[0],p=x[1],k=Object(c.useState)(!0),I=Object(i.a)(k,2),C=I[0],M=(I[1],Object(c.useState)(1)),N=Object(i.a)(M,2),S=N[0],T=N[1],w=Object(c.useRef)(null),A="api/chat/detailat?talker=".concat(t.talker,"&createTime=").concat(n,"&direction=prev&pageIndex=").concat(h,"&pageSize=10");Object(c.useEffect)((function(){p(!0),d.a.get(A).then((function(e){var t=[];e.data.rows.forEach((function(e){t.unshift({_id:e.msgSvrId+Math.floor(9999*Math.random()),type:e.type+"",content:e,position:1===e.isSend?"right":"left",user:{avatar:""!==e.userInfo.reserved2?e.userInfo.reserved2:e.userInfo.localAvatar,name:e.userInfo.conRemark?e.userInfo.conRemark:e.userInfo.nickName},hasTime:!0,createdAt:e.createTime})})),l(t),p(!1)})).catch((function(){p(!1)}))}),[A]);var E="api/chat/detailat?talker=".concat(t.talker,"&createTime=").concat(n,"&direction=next&pageIndex=").concat(S,"&pageSize=10");Object(c.useEffect)((function(){p(!0),d.a.get(E).then((function(e){var t=[];e.data.rows.forEach((function(e){t.push({_id:e.msgSvrId+Math.floor(9999*Math.random()),type:e.type+"",content:e,position:1===e.isSend?"right":"left",user:{avatar:""!==e.userInfo.reserved2?e.userInfo.reserved2:e.userInfo.localAvatar,name:e.userInfo.conRemark?e.userInfo.conRemark:e.userInfo.nickName},hasTime:!0,createdAt:e.createTime})})),j(t),p(!1)})).catch((function(){p(!1)}))}),[E]),Object(c.useEffect)((function(){p(!0);var e="api/chat/detailat?talker=".concat(t.talker,"&createTime=").concat(n,"&direction=prev&pageIndex=").concat(h,"&pageSize=10"),c="api/chat/detailat?talker=".concat(t.talker,"&createTime=").concat(n,"&direction=next&pageIndex=").concat(h,"&pageSize=10"),a=function(){var t=Object(u.a)(Object(o.a)().mark((function t(){var n,a,r,s,l,u,b,m;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Promise.all([d.a.get(e),d.a.get(c)]);case 3:n=t.sent,a=Object(i.a)(n,2),r=a[0],s=a[1],l=r.data,u=s.data,b=[],l&&l.rows.forEach((function(e){b.unshift({_id:e.msgSvrId+Math.floor(9999*Math.random()),type:e.type+"",content:e,position:1===e.isSend?"right":"left",user:{avatar:""!==e.userInfo.reserved2?e.userInfo.reserved2:e.userInfo.localAvatar,name:e.userInfo.conRemark?e.userInfo.conRemark:e.userInfo.nickName},hasTime:!0,createdAt:e.createTime})})),u&&(m=b.length,u.rows.forEach((function(e){b.push({_id:e.msgSvrId+Math.floor(9999*Math.random()),type:e.type+"",content:e,position:1===e.isSend?"right":"left",user:{avatar:""!==e.userInfo.reserved2?e.userInfo.reserved2:e.userInfo.localAvatar,name:e.userInfo.conRemark?e.userInfo.conRemark:e.userInfo.nickName},hasTime:!0,createdAt:e.createTime})})),w.current=b[m]._id,j(b)),p(!1),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(0),console.error("Error fetching data:",t.t0),p(!1);case 19:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(){return t.apply(this,arguments)}}();a()}),[]),Object(c.useEffect)((function(){var e=document.getElementById(w.current);if(e)for(var t=e;t.parentNode;)if("MessageBubble"===(t=t.parentNode).className){t.scrollIntoView(),w.current=null;break}}),[s]);return Object(f.jsx)(f.Fragment,{children:Object(f.jsx)(B,{name:t.name,messages:s,fetchMoreData:function(){v||g(h+1)},hasMore:C&&!v,renderMessageContent:_,onClickBack:a,moreVisibility:"hidden",atBottom:function(){v||T(S+1)}})})}v.a.extend(A.a),v.a.extend(R.a),v.a.tz.setDefault();var F=function(e){var t=e.onClickBack;return Object(f.jsxs)("div",{className:"CalendarBar",children:[Object(f.jsx)(j.IconButton,{className:"CalendarBar--Btn",icon:"chevron-left",onClick:t}),Object(f.jsx)(j.Text,{className:"CalendarBar--Text",truncate:1,children:"\u6309\u7167\u65e5\u671f\u67e5\u627e"}),Object(f.jsx)(j.IconButton,{className:"CalendarBar--Btn",icon:"chevron-left",style:{visibility:"hidden"}})]})},P=function(){return Object(f.jsx)("div",{className:"CalendarLoading",children:Object(f.jsx)(N.a,{tip:"\u52a0\u8f7d\u4e2d...",size:"large",children:Object(f.jsx)("div",{className:"content"})})})},U=function(e){var t=e.info,n=e.onClickBack,a=Object(c.useState)([]),r=Object(i.a)(a,2),s=r[0],o=r[1],l=Object(c.useState)(!0),u=Object(i.a)(l,2),j=u[0],b=u[1],m=Object(c.useState)(!0),h=Object(i.a)(m,2),g=h[0],O=h[1],x=Object(c.useRef)(1),p=Object(c.useRef)(null);Object(c.useEffect)((function(){d.a.get("/api/chat/msgdate?talker=".concat(t.talker)).then((function(e){o(e.data.date),b(!1)})).catch()}),[t.talker]);var k=Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(F,{onClickBack:n}),j?Object(f.jsx)(P,{}):Object(f.jsx)(S.a,{fullscreen:!1,disabledDate:function(e){for(var t=0;t<s.length;t++)if(e.isSame(v()(s[t])))return!1;return!0},locale:T.a,validRange:s.length>0?[v()(s[s.length-1]),v()(s[0])]:void 0,defaultValue:p.current?p.current:s.length>0?v()(s[0]):void 0,onSelect:function(e,t){"date"===t.source&&(x.current=e.valueOf(),O(!1),p.current=e)}})]});return g?k:Object(f.jsx)(z,{info:t,createTime:x.current,onClickBack:function(){return O(!0)}})},W=n(223),L=(n(212),function(e){var t=e.onClickBack;return Object(f.jsxs)("div",{className:"ImagesUIBar",children:[Object(f.jsx)(j.IconButton,{className:"ImagesUIBar--Btn",icon:"chevron-left",onClick:t}),Object(f.jsx)(j.Text,{className:"ImagesUIBar--Text",truncate:1,children:"\u56fe\u7247\u53ca\u89c6\u9891"}),Object(f.jsx)(j.IconButton,{className:"ImagesUIBar--Btn",icon:"chevron-left",style:{visibility:"hidden"}})]})});function V(e){var t=e.info;return Object(c.useMemo)((function(){return function(e){return Object(f.jsxs)("div",{className:"preview-ImageItem",children:[Object(f.jsx)(D.a,{className:"preview-ImageItem-img",width:96,height:128,src:"image"===e.type?e.src:e.preview,loading:"lazy"}),Object(f.jsx)(j.Icon,{className:"preview-ImageItem-icon",type:"image"===e.type?"image":"play-circle"})]})}(t)}),[t])}function H(e){var t=e.talker,n=e.onClickBack,a=y([]),r=a.messages,s=(a.prependMsgs,a.appendMsgs),o=Object(c.useState)(1),l=Object(i.a)(o,2),u=l[0],j=l[1],b=Object(c.useState)(!1),h=Object(i.a)(b,2),g=h[0],x=h[1],v=Object(c.useState)(!0),p=Object(i.a)(v,2),k=p[0],I=p[1],B="apt/media/list?talker=".concat(t,"&pageIndex=").concat(u,"&pageSize=28");Object(c.useEffect)((function(){x(!0),d.a.get(B).then((function(e){var t=[];e.data.rows.forEach((function(e){t.push({type:3===e.type?"image":"video",preview:3===e.type?e.mediaPath:e.imgPath,src:3===e.type&&(e.mediaSourcePath||e.mediaBCKPath)||e.mediaPath,createdAt:e.createTime})})),0===t.length?I(!1):s(t),x(!1)})).catch((function(){x(!1)}))}),[B]);return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(L,{onClickBack:n}),Object(f.jsxs)(O.a,{className:"ImageUI--InfiniteScroll",dataLength:r.length,hasMore:k,next:function(){g||j(u+1)},height:770,endMessage:Object(f.jsx)("div",{className:"endMessage-div",children:Object(f.jsx)("p",{children:"- \u5df2\u7ecf\u5230\u5e95\u5566 -"})}),children:[Object(f.jsx)("div",{className:"ImageUI-list",children:Object(f.jsx)(D.a.PreviewGroup,{preview:{onChange:function(e,t){return console.log("current index: ".concat(e,", prev index: ").concat(t))},imageRender:function(e,t){return 0===r.length||"image"===r[t.current].type?e:Object(f.jsx)("video",{className:"video_view",height:"100%",width:"100%",controls:!0,src:r[t.current].src})},toolbarRender:function(e,t){return"image"==r[t.current].type?e:null},onVisibleChange:function(e,t,n){if(!1===e&&!0===t&&"video"===r[n].type){var c=document.getElementsByClassName("video_view");console.log(c),c[0].pause()}console.log("visible",e,"prevVisible",t,"current",n)}},children:r.map((function(e){return Object(f.jsx)(V,{info:e},Object(m.a)())}))})}),Object(f.jsx)(W.a.BackTop,{})]})]})}function Y(e){var t=new Date(e),n=t.getFullYear(),c=t.getMonth()+1,a=t.getDate();t.getHours(),t.getMinutes(),t.getSeconds();return"".concat(n,"-").concat(c,"-").concat(a)}function K(e){var t;return Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)("div",{className:"searchui--bar",children:[Object(f.jsx)(j.Icon,{className:"searchui--bar--icon",type:"search"}),Object(f.jsx)(j.Input,{className:"searchui--bar--input",placeholder:"\u641c\u7d22",onChange:function(n){clearTimeout(t),t=setTimeout((function(){console.log(n),e.onChangeKeyWord(n)}),300)}}),Object(f.jsx)(j.Button,{className:"searchui--bar--button",onClick:function(){return e.onClickButton("Back")},children:"\u53d6\u6d88"})]})})}function J(e){return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(j.Flex,{className:"searchui--content",center:!0,children:Object(f.jsx)(j.Text,{className:"searchui-text",children:"\u641c\u7d22\u6307\u5b9a\u5185\u5bb9"})}),Object(f.jsx)(j.Flex,{className:"searchui--button",center:!0,children:Object(f.jsx)("table",{className:"searchui--table",children:Object(f.jsxs)("tbody",{children:[Object(f.jsxs)("tr",{children:[Object(f.jsx)("td",{children:Object(f.jsx)(j.Button,{onClick:function(){return e.onClickButton("Date")},children:"\u65e5\u671f"})}),Object(f.jsx)("td",{children:Object(f.jsx)(j.Button,{onClick:function(){return e.onClickButton("Img")},children:"\u56fe\u7247\u53ca\u89c6\u9891"})}),Object(f.jsx)("td",{children:Object(f.jsx)(j.Button,{children:"\u6587\u4ef6"})})]}),Object(f.jsxs)("tr",{children:[Object(f.jsx)("td",{children:Object(f.jsx)(j.Button,{children:"\u94fe\u63a5"})}),Object(f.jsx)("td",{children:Object(f.jsx)(j.Button,{disabled:!0,children:"\u97f3\u4e50"})}),Object(f.jsx)("td",{children:Object(f.jsx)(j.Button,{disabled:!0,children:"\u4ea4\u6613"})})]})]})})})]})}function X(e){var t=Object(c.useState)([]),n=Object(i.a)(t,2),a=n[0],r=n[1],s=Object(c.useState)(!0),o=Object(i.a)(s,2),l=o[0],u=o[1];function j(t){var n=0==t?Date.now():a.length>0?a[a.length-1].key:Date.now();console.log("createTime: ",n),d.a.get("api/chat/detailkw?talker=".concat(e.user,"&createTime=").concat(n,"&pageSize=20&keyWord=").concat(e.keyWord)).then((function(e){if(0===e.data.total)return u(!1),void console.log("setIsHasMore(false);");var n=[];e.data.rows.forEach((function(e){n.push({text:e.content,date:Y(e.createTime),Avatar:""!==e.userInfo.reserved2?e.userInfo.reserved2:e.userInfo.localAvatar,name:e.userInfo.conRemark?e.userInfo.conRemark:e.userInfo.nickName,key:e.createTime})})),r(t?a.concat(n):n)})).catch()}return Object(c.useEffect)((function(){r([]),console.log("useEffect"),u(!0),j(!1)}),[e.keyWord]),Object(f.jsx)("div",{className:"keyWord--InfiniteScroll--outside",children:Object(f.jsx)(O.a,{className:"keyWord--InfiniteScroll",dataLength:a.length,hasMore:l,next:function(){console.log("fetchMoreData(true)"),j(!0)},height:770,children:Object(f.jsx)("div",{className:"keyWord--InfiniteScroll--div",children:a.map((function(t){return Object(f.jsx)(h,{onClick:function(){return function(t){console.log(t),e.onClikItem(t)}(t)},Avatar:t.Avatar,name:t.name,text:t.text,date:t.date},t.key)}))})})})}function G(e){var t=Object(c.useState)("Main"),n=Object(i.a)(t,2),a=n[0],r=n[1],s=Object(c.useState)(""),o=Object(i.a)(s,2),l=o[0],u=o[1],j=Object(c.useState)(!0),d=Object(i.a)(j,2),b=d[0],m=d[1],h=Object(c.useRef)(0);function g(t){switch(t){case"Back":e.onClickBack();break;case"Date":r("Date");break;case"Img":r("Img");break;default:console.log("unknown click ",t)}}var O=Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(K,{onChangeKeyWord:function(e){u(e)},onClickButton:g}),""===l?Object(f.jsx)(J,{onClickButton:g}):Object(f.jsx)(X,{keyWord:l,user:e.info.talker,onClikItem:function(e){h.current=e.key-1,m(!1)}})]});return Object(f.jsx)(f.Fragment,{children:function(){switch(a){case"Main":return Object(f.jsx)(f.Fragment,{children:b?O:Object(f.jsx)(z,{info:e.info,createTime:h.current,onClickBack:function(){return m(!0)}})});case"Date":return Object(f.jsx)(U,{info:e.info,onClickBack:function(){return r("Main")}});case"Img":return Object(f.jsx)(H,{talker:e.info.talker,onClickBack:function(){return r("Main")}});default:return Object(f.jsx)("div",{children:"unknown"})}}()})}function q(e){var t=y([]),n=t.messages,a=t.prependMsgs,r=(t.appendMsgs,Object(c.useState)(1)),s=Object(i.a)(r,2),o=s[0],l=s[1],u=Object(c.useState)(!1),j=Object(i.a)(u,2),b=j[0],m=j[1],h=Object(c.useState)(!0),g=Object(i.a)(h,2),O=g[0],x=(g[1],Object(c.useState)(!1)),v=Object(i.a)(x,2),p=v[0],k=v[1],I="api/chat/detail?talker=".concat(e.info.talker,"&pageIndex=").concat(o,"&pageSize=10");Object(c.useEffect)((function(){m(!0),d.a.get(I).then((function(e){var t=[];e.data.rows.forEach((function(e){t.unshift({_id:e.msgSvrId+Math.floor(9999*Math.random()),type:e.type+"",content:e,position:1===e.isSend?"right":"left",user:{avatar:""!==e.userInfo.reserved2?e.userInfo.reserved2:e.userInfo.localAvatar,name:e.userInfo.conRemark?e.userInfo.conRemark:e.userInfo.nickName},hasTime:!0,createdAt:e.createTime})})),a(t),m(!1)})).catch((function(){m(!1)}))}),[I]);return Object(f.jsx)(f.Fragment,{children:p?Object(f.jsx)(G,{info:e.info,onClickBack:function(){return k(!1)}}):Object(f.jsx)(B,{name:e.info.name,messages:n,fetchMoreData:function(){b||l(o+1)},hasMore:O&&!b,renderMessageContent:_,onClickBack:e.onClickBack,onClickMore:function(){return k(!0)}})})}function Q(){var e=Object(c.useState)(!1),t=Object(i.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)({}),s=Object(i.a)(r,2),o=s[0],l=s[1];return Object(f.jsx)("div",{className:"Main-div",children:Object(f.jsx)("div",{className:"Main-sub-div",children:n?Object(f.jsx)(q,{info:o,onClickBack:function(){a(!1)}}):Object(f.jsx)(g,{onClickMe:function(e){console.log(e),l(e),a(!0)}})})})}n(213);var Z=document.getElementById("root");s.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(Q,{})}),Z)}},[[214,1,2]]]);
//# sourceMappingURL=main.feaa2806.chunk.js.map